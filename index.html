<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EvolutionGlute.IA</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
    <script src="https://player.vimeo.com/api/player.js"></script>
    <style>
        /* ... Pega aquí TODO tu CSS original ... */
    </style>
</head>
<body>

    <div id="subscription-area" style="margin: 20px 0;">
        <div id="wallet_container"></div>
    </div>
    <div id="main-app-buttons" style="display:none;">
        </div>


<script src="https://sdk.mercadopago.com/js/v2"></script>
<script type="module">
    // --- IMPORTACIONES Y CONFIG DE FIREBASE ---
    import { initializeApp } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";
    // ... y el resto de tus importaciones ...

    const firebaseConfig = { /* ... tu config ... */ };
    const app = initializeApp(firebaseConfig);
    const auth = getAuth(app);
    // ... resto de inicializaciones ...
    
    // --- LÓGICA DE MERCADO PAGO ---
    function renderCheckoutButton() {
        const mp = new MercadoPago('APP_USR-8ec6b9fe-500c-4ad8-9c19-0ba035211799', { locale: 'es-AR' });
        fetch('/api/create_preference', { method: 'POST' })
        .then(res => res.ok ? res.json() : Promise.reject(res.json()))
        .then(data => {
            if (data.id) {
                document.getElementById('wallet_container').innerHTML = '';
                mp.wallet({ preferenceId: data.id, render: { container: '#wallet_container' } });
            }
        })
        .catch(error => {
            console.error(error);
            document.getElementById('wallet_container').innerText = 'Error al generar botón de pago.';
        });
    }

    // --- LÓGICA DE TU APP ---
    // ... tus funciones showSection, showModal, etc. ...
    
    onAuthStateChanged(auth, (user) => {
        if (user) {
            // ... tu código de bienvenida ...
            const isSubscribed = false; // Lógica para verificar suscripción irá aquí
            if (!isSubscribed) {
                renderCheckoutButton();
            }
        } else {
            // ... tu código para mostrar el login ...
        }
    });
</script>
</body>
</html>